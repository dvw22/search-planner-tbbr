% Area measure
area_measure = LidarSensor;
lidar.sensorOffset = [0,0];
lidar.scanAngles = linspace(-pi/6,pi/6,9);
lidar.maxRange = 5;

% Create visualizer
viz = Visualizer2D;
viz.mapName = 'map';
attachLidarSensor(viz,lidar);

search_matrix = occupancyMatrix(map);

%% Simulation parameters
sampleTime = 0.1;              % Sample time [s]
initPose = [1; 3; pi/4];        % Initial pose (x y theta)
pose = initPose

%% Simulation loop
r = rateControl(1/sampleTime);
for idx = 2:numel(tVec)       
    % Update lidar and visualization
    ranges = lidar(pose);
    
    for i = 1:size(ranges(1,:))
        grid_units = raycast(map,pose,lidar.maxRange,lidar.scanAngles(i));
        row_idx = grid_units(
        
        col_idx
        
    
    viz(pose,ranges)
    waitfor(r);
end